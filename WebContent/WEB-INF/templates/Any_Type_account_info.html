<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Account Data</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      border: 1px solid black;
      padding: 8px;
      text-align: left;
    }
    
    th {
      background-color: #f2f2f2;
    }
    
    .form-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      overflow: auto;
    }
    
    .form-container {
      max-width: 500px;
      margin: 100px auto;
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    
    .form-container label {
      display: block;
      margin-bottom: 10px;
    }
    
    .form-container input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 20px;
      box-sizing: border-box;
    }
    
    .form-container button {
      padding: 8px 16px;
      border: none;
      background-color: #4CAF50;
      color: #fff;
      cursor: pointer;
    }
    
    .form-container button:hover {
      background-color: #45a049;
    }

    h1 {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>Saving Accounts</h2>
  <table>
    <thead>
      <tr>
        <th>acnt_acty_id</th>
        <th>acnt_acap_id</th>
        <th>acnt_cust_id</th>
        <th>acnt_cdate</th>
        <th>acnt_type_id</th>
        <th>acnt_processedy</th>
        <th>account_nominee</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="account, rowStat : ${list_of_account}" id="row-${rowStat.index + 1}">
        <td data-column="acnt_type_id" th:text="${account.getAccountTypeId()}"></td>
        <td data-column="acnt_acap_id" th:text="${account.getApplicationId()}"></td>
        <td data-column="acnt_cust_id" th:text="${account.getCustomerId()}"></td>
        <td data-column="acnt_cdate" th:text="${account.getApplicationDate()}"></td>
        <td data-column="acnt_processedy" th:text="${account.getProcessedBy()}"></td>
        <td data-column="account_nominee" th:text="${account.getApplicationNomineeFirstName()}"></td>
        <td data-column="account_nominee" th:text="${account.getApplicationNomineeLastName()}"></td>
        <td>
          <button onclick="editRow(this)">Edit</button>
          
        </td>
      </tr>
    </tbody>
  </table>

  <div class="form-popup" id="edit-popup">
    <div class="form-container" id="edit-form-container">
      <!-- Form fields will be dynamically generated here -->
    </div>
  </div>

  <script>
    function editRow(button) {
    	console.log(button);
      var row = button.parentNode.parentNode;
      var rowIndex = row.rowIndex;
      var accountId = row.getAttribute('id').split('-')[1];

      var formContainer = document.getElementById('edit-form-container');
      formContainer.innerHTML = '';

      // Generate form fields dynamically
      var accountTypeId = row.querySelector('[data-column="acnt_type_id"]').textContent;
      var acapId = row.querySelector('[data-column="acnt_acap_id"]').textContent;
      var custId = row.querySelector('[data-column="acnt_cust_id"]').textContent;
      var cdate = row.querySelector('[data-column="acnt_cdate"]').textContent;
      var processedy = row.querySelector('[data-column="acnt_processedy"]').textContent;
      var nomineeFirstName = row.querySelector('[data-column="account_nominee"]').textContent;
      var nomineeLastName = row.querySelector('[data-column="account_nominee"]').textContent;

      var formFields = [
        { label: 'acnt_type_id', value: accountTypeId },
        { label: 'acnt_acap_id', value: acapId },
        { label: 'acnt_cust_id', value: custId },
        { label: 'acnt_cdate', value: cdate },
        { label: 'acnt_processedy', value: processedy },
        { label: 'account_nominee_first_name', value: nomineeFirstName },
        { label: 'account_nominee_last_name', value: nomineeLastName }
      ];

      formFields.forEach(function(field) {
        var label = document.createElement('label');
        label.textContent = field.label;

        var input = document.createElement('input');
        input.type = 'text';
        input.value = field.value;

        formContainer.appendChild(label);
        formContainer.appendChild(input);
      });

      var saveButton = document.createElement('button');
      saveButton.textContent = 'Save';
      saveButton.onclick = function() {
        saveFormData(accountId);
      };

      formContainer.appendChild(saveButton);

      // Open the form popup
      var popup = document.getElementById('edit-popup');
      popup.style.display = 'block';
    }

    function saveFormData(accountId) {
      // Retrieve updated values from the form fields
      var formContainer = document.getElementById('edit-form-container');
      var formInputs = formContainer.getElementsByTagName('input');
      var updatedData = {};

      for (var i = 0; i < formInputs.length; i++) {
        var input = formInputs[i];
        updatedData[input.name] = input.value;
      }

      // Update the corresponding row in the table
      var row = document.getElementById('row-' + accountId);
      var columns = row.getElementsByTagName('td');

      for (var j = 0; j < columns.length; j++) {
        var column = columns[j];
        var columnName = column.getAttribute('data-column');
        column.textContent = updatedData[columnName];
      }

      // Close the form popup
      var popup = document.getElementById('edit-popup');
      popup.style.display = 'none';
    }
  </script>
</body>
</html>
